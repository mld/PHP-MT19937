<?php


use MLD\MersenneTwister\MersenneTwister;

it('generates the expected numbers', function () {
    $mt = new MersenneTwister();

    $expected = [
        527860569,
        1711027313,
        1280820687,
        688176834,
        770499160,
        412773096,
        813703253,
        898651287,
        52508912,
        757323740,
        511765911,
        274407457,
        833082629,
        1923803667,
        1461450755,
        1301698200,
        1802470719,
        689771423,
        1633670016,
        808754692,
        476186451,
        2043136441,
        136239837,
        908611312,
        1673842702,
        1636867766,
        1549927803,
        84267035,
        416909991,
        1439683927,
        1098355576,
        460944625,
        147753464,
        878412611,
        846414958,
        1393204608,
        2108244115,
        67161823,
        654786038,
        326675982,
        1679244165,
        650628317,
        1577769080,
        470011788,
        1800174533,
        843743539,
        261112752,
        1687675167,
        1863671194,
        1218572829,
        1204127574,
        60747995,
        1796736152,
        1001923554,
        1587021514,
        1914079533,
        1687354776,
        699869700,
        1466634587,
        431082620,
        1965615399,
        305240476,
        478007641,
        2027641207,
        1229830284,
        895067406,
        1353467501,
        1466462550,
        28759359,
        1508391469,
        564364227,
        395845340,
        1567696910,
        676422716,
        1698361169,
        1796866033,
        697172647,
        936285464,
        594081355,
        268667831,
        264069704,
        1705186559,
        880217974,
        306266427,
        2045943928,
        1378829767,
        513459392,
        263457822,
        21835227,
        935064713,
        40473707,
        233948319,
        1417375719,
        265576846,
        1466356449,
        1981875292,
        1505012396,
        1604437251,
        1504431408,
        540878095,
        1363080848,
        41511539,
        1620451880,
        1781756221,
        1180288922,
        2119131564,
        1557665507,
        29433392,
        1434227072,
        342128402,
        152800186,
        1733092982,
        1535778905,
        343653020,
        1345664408,
        868164676,
        1646015005,
        1671205111,
        1489673388,
        733551257,
        973673789,
        1435356372,
        1524134889,
        712530069,
        601800419,
        1376636894,
        1872346058,
        2045978553,
        1121096978,
        946529511,
        1636966681,
        1789895382,
        1043362278,
        88020350,
        196822556,
        1254590639,
        57370696,
        1970815539,
        26770723,
        703506099,
        824275968,
        25982600,
        1765586025,
        563810317,
        2057020011,
        1695864623,
        488070802,
        463619238,
        584421426,
        381108205,
        183117220,
        1294147469,
        676038688,
        1444470162,
        1135308046,
        647530564,
        1920546729,
        387850234,
        156687964,
        1130917685,
        2041041307,
        24645360,
        807753094,
        1636655478,
        472140366,
        415857671,
        1943537933,
        1249460021,
        346598181,
        1180264103,
        1867711329,
        653565821,
        444739496,
        119961579,
        1528090664,
        1891519540,
        443012129,
        59645303,
        831707102,
        1332368793,
        1304797897,
        1938668590,
        585426809,
        1659281534,
        507754143,
        1614300034,
        561876619,
        1373143302,
        1499681282,
        694183868,
        1506951086,
        148245877,
        464948162,
        574828531,
        753057260,
        1354420782,
        1830880247,
        1817567258,
        1161853926,
        1692414740,
        1307905490,
        1622418528,
        1363178419,
        1510681101,
        1967190112,
        1497256184,
        316118879,
        815314996,
        1277251004,
        738588996,
        1454362264,
        1801303414,
        1662748532,
        771792259,
        244253878,
        105676500,
        1249522265,
        309286661,
        1445543713,
        2029503161,
        543748119,
        1101571984,
        1452879798,
        1917004001,
        760492278,
        173678688,
        34838184,
        1772884786,
        1924767994,
        1541463273,
        1610997554,
        1995074354,
        1644235313,
        995699931,
        1125337038,
        1314877749,
        1086611421,
        1090394155,
        1422005454,
        566331009,
        2017833579,
        1828223107,
        1633743569,
        702533229,
        858051200,
        882580313,
        1512305252,
        1538891704,
        56272189,
        388097984,
        1316311462,
        1546167143,
        674620634,
        138975599,
        344125626,
        1872963827,
        987330438,
        1332338581,
        1870071271,
        267133939,
        389335953,
        966774096,
        23849460,
        1325281917,
        2125056620,
        1847351943,
        844915209,
        927270170,
        689715635,
        1039668596,
        705317786,
        1819135221,
        900228424,
        869957023,
        147913600,
        890766821,
        2061361605,
        685654065,
        1326617779,
        1293650168,
        1845681628,
        1137656854,
        316389951,
        697572124,
        1063796802,
        724985825,
        462235451,
        940471726,
        578426275,
        1800690839,
        538341942,
        2131039219,
        364648470,
        1944623721,
        167817977,
        2006528716,
        1122882217,
        1400825663,
        1544332416,
        818843191,
        885881320,
        443405394,
        1884075124,
        831746346,
        921851788,
        1145517466,
        1704027916,
        502706881,
        338797238,
        1739873634,
        1056967445,
        493800832,
        2020468498,
        1226950929,
        548957227,
        1894530621,
        1230289612,
        2081099801,
        853196758,
        1476310154,
        120915720,
        912005456,
        770893463,
        461911801,
        1444925798,
        503320590,
        836178962,
        132603865,
        905517178,
        958889006,
        1965399186,
        1066958497,
        1986218292,
        1013326429,
        1974798408,
        850623061,
        1328884359,
        1274515511,
        916459709,
        1695670563,
        399430972,
        1422635913,
        574281953,
        306859338,
        40783053,
        853837040,
        846981758,
        1731023158,
        1396129423,
        1356080603,
        674417379,
        1663017531,
        1138087037,
        693756529,
        226860910,
        1186151015,
        1569396623,
        1152642001,
        1643631856,
        540876562,
        1870979965,
        493387445,
        343750943,
        545479405,
        2079207099,
        766656550,
        1197577544,
        988270898,
        1225610748,
        564550544,
        159029175,
        1898265798,
        1613056115,
        1432434574,
        283959773,
        378891428,
        429269190,
        59650317,
        386453463,
        1352024247,
        1911561203,
        656575290,
        1170219977,
        1716195902,
        2093499175,
        619781133,
        712742643,
        109841701,
        218217624,
        280130373,
        125487075,
        974142048,
        163175076,
        47190783,
        773816714,
        1248643565,
        2078314205,
        12435790,
        2105236380,
        378636461,
        1875189970,
        2080861375,
        1848850182,
        1495757110,
        1177717979,
        2135040628,
        268873556,
        193915854,
        272435358,
        1295026463,
        1738235696,
        1641388155,
        2030111051,
        970269604,
        2096129956,
        342618890,
        544383039,
        2084000368,
        2016111379,
        1575207758,
        1269853017,
        1013385498,
        1650332483,
        79832429,
        1105144975,
        84654321,
        674261760,
        1055655997,
        1991071841,
        1156925601,
        1691609579,
        681838361,
        727498714,
        1270701199,
        1978795938,
        1143953281,
        1462082818,
        804534852,
        1223704739,
        771051664,
        726492452,
        699824192,
        179256475,
        1692745070,
        959113727,
        741281198,
        547006157,
        468338864,
        1027579136,
        972949268,
        332152840,
        860494239,
        1813360843,
        1194959637,
        1674602324,
        1021222426,
        332264512,
        1874085847,
        1149914691,
        884484438,
        1445417270,
        1599923347,
        326940020,
        705305965,
        878933358,
        437561312,
        1619291763,
        1947311585,
        334524756,
        159328214,
        1248311618,
        1532066922,
        1009511555,
        881691468,
        553235034,
        1549493380,
        991599182,
        1010941553,
        255876325,
        317016757,
        1895519679,
        141918330,
        424807946,
        413505676,
        707983848,
        2014760132,
        1648873014,
        530903934,
        972809374,
        1476346580,
        1906400855,
        130508835,
        1481836289,
        2042686144,
        2044268167,
        1131206924,
        1507003798,
        1402476262,
        1034944317,
        1644396593,
        1078440764,
        276354105,
        610476528,
        875298663,
        1776631521,
        1336927780,
        695998279,
        1735481027,
        1527669606,
        130663099,
        1054681336,
        2006590373,
        1637037673,
        1696327006,
        1317861146,
        1280532833,
        953907940,
        2124805191,
        219503140,
        1540412650,
        518363323,
        69843705,
        385204121,
        1106215787,
        2084895806,
        1414027344,
        506628960,
        1599409907,
        830359149,
        69187523,
        2146415008,
        1399394838,
        871938379,
        1900719346,
        818505208,
        14784588,
        761285050,
        2012870148,
        536518127,
        1384641903,
        809082750,
        335687582,
        443006014,
        1685978517,
        1692853278,
        1928280105,
        401901912,
        506290432,
        2126741003,
        135185942,
        53960454,
        1668767340,
        283426216,
        455274192,
        662683145,
        817306971,
        604963713,
        431808180,
        1511373224,
        1293188215,
        1565043137,
        1813346943,
        1470362237,
        915293708,
        619271445,
        1628462953,
        821145544,
        1108023338,
        228855682,
        2058353095,
        147664170,
        104913566,
        427057532,
        1960006748,
        1887955132,
        416257050,
        156569834,
        1635612957,
        333350371,
        1456114707,
        830184061,
        1833670362,
        928037218,
        1501435531,
        1070047451,
        1026852794,
        1737303388,
        1428899611,
        35091983,
        433055558,
        487183859,
        1594770973,
        671111189,
        1967830359,
        1147152394,
        1796395819,
        527703459,
        1511957812,
        1795785429,
        896739710,
        2137540696,
        152773338,
        604918239,
        1271445135,
        602191855,
        418729613,
        1549668843,
        2009008932,
        815032606,
        291097419,
        1844286261,
        391896483,
        635833856,
        1069360694,
        1595522686,
        858944154,
        1645569061,
        489923429,
        1342641534,
        1236373893,
        1101460110,
        827369731,
        117519361,
        266269072,
        827087157,
        69146664,
        1089834257,
        1560526866,
        1602886207,
        218488629,
        2043410708,
        1692665426,
        172036090,
        1287240484,
        776399943,
        698413135,
        1528636172,
        11565788,
        984715804,
        1047002944,
        1280208522,
        712558985,
        1058822199,
        1341729080,
        1016830911,
        547796989,
        1069456992,
        464736066,
        678756723,
        328229957,
        373667141,
        1029620103,
        2012985051,
        983583954,
        1306905996,
        876303685,
        191001258,
        341907386,
        2012360265,
        422365278,
        1888650091,
        1909717717,
        180674519,
        27378535,
        1348263192,
        129855625,
        753232918,
        1228157749,
        1493032998,
        1000402518,
        53718146,
        97243944,
        1837887933,
        269605212,
        1396649115,
        1739330059,
        1680409831,
        1750181629,
        978217770,
        1624244099,
        39305918,
        256320757,
        655987527,
        1114804345,
        174953513,
        267466526,
        2113630818,
        1618685742,
        1722431714,
        480382752,
        1352995712,
        817470033,
        517813273,
        1824461384,
        1670963610,
        1322420113,
        327191645,
        1627829457,
        2129650170,
        1358746612,
        1235191833,
        1488129476,
        11995268,
        376923042,
        1987415799,
        1938118689,
        1937354851,
        1770982624,
        443532510,
        1733820959,
        1254762254,
        290673620,
        2011713996,
        1304549707,
        1358582076,
        1969720833,
        390065465,
        1459960418,
        1779157946,
        137653528,
        406674318,
        1892055021,
        1828241133,
        678090327,
        285570035,
        1032657655,
        481160358,
        1177832326,
        1705568434,
        297732109,
        1527937929,
        1382864012,
        1638614592,
        849607534,
        1826755477,
        1403993719,
        1522379431,
        425754425,
        1692726091,
        936405680,
        366066020,
        749532889,
        1731495367,
        1446593091,
        630432401,
        1113255320,
        1104570766,
        2093495710,
        600398031,
        1404079706,
        1080176554,
        1961098976,
        1746724607,
        1841661251,
        40950724,
        619574940,
        753220517,
        1915766410,
        273434960,
        1117365754,
        1808895874,
        174309172,
        1829631859,
        1001579050,
        94137128,
        1835622104,
        717024692,
        79987939,
        1762119018,
        348867866,
        178410885,
        1097368062,
        170086846,
        1833826429,
        1409953551,
        253898730,
        2094350766,
        1684810374,
        204189162,
        813385328,
        311160804,
        1156569737,
        913273726,
        1390063593,
        944013721,
        12209056,
        1881852914,
        326835214,
        1787677315,
        733193152,
        1478138680,
        1943105432,
        1237971623,
        389547552,
        618949329,
        1999437088,
        1164361504,
        1680577953,
        1403351306,
        1927173742,
        580483876,
        467153206,
        1599809086,
        1237191816,
        1782942165,
        123874696,
        428438368,
        322226345,
        1586134856,
        721200071,
        974084335,
        1932629867,
        1418560262,
        1526372428,
        425280423,
        1563186962,
        836246710,
        1457633347,
        1028013455,
        977114273,
        1373452721,
        979152478,
        1038141857,
        2141903495,
        1199291947,
        889986661,
        2077420789,
        1411044024,
        2033299787,
        687131440,
        469855700,
        497367845,
        723237684,
        1136041452,
        1639127955,
        1846802242,
        2142499220,
        1783039285,
        1293917909,
        128474292,
        1808804930,
        544181782,
        249252134,
        1418921954,
        1199063210,
        1963427126,
        1319300285,
        253776958,
        560009428,
        96724359,
        611652370,
        1682544254,
        567500851,
        1766654594,
        1311647513,
        581786346,
        1531402723,
        1595525509,
        1008142783,
        141289474,
        445203462,
        91664976,
        989787428,
        1017874648,
        1027178628,
        943183257,
        1238603264,
        222095638,
        1523236954,
        1875285079,
        49900115,
        167869996,
        388211644,
        179918424,
        513547871,
        1157777829,
        1577465086,
        1645438013,
        778947110,
        2139684571,
        2138257761,
        1377684463,
        1406095004,
        50008514,
        1906153754,
        1582469330,
        947952336,
        1535362028,
        1741545426,
        201154166,
        1635122647,
        722013331,
        2001466129,
        1177922218,
        256205822,
        1698513895,
        480260038,
        1082136112,
        1428459782,
        1315397883,
        2066586772,
        1145834680,
        790665715,
        1000826410,
        219993880,
        1342662168,
        1651770229,
        2067212206,
        2135360611,
        428157484,
        659267233,
        1337229061,
        1909889846,
        1682490839,
        405810053,
        1938081777,
        28579176,
        182233542,
        129407655,
        716224047,
        2089047990,
        234224004,
        1224097182,
        1665558085,
        85560438,
        2134296539,
        787931217,
        444509657,
        498124453,
        1924706611,
        1258487841,
        681763871,
        2053692125,
        365207526,
        1792091422,
        476893502,
        2078606424,
        1487606228,
        681958410,
        1412420021,
        279961469,
        722411089,
        1307522653,
        1204836864,
        823564613,
        496955598,
        1956451963,
        1818205350,
        932062684,
        1046720152,
        1049333371,
        96009310,
        176043768,
        134374692,
        35067977,
        88764636,
        2052259568,
        1789523253,
        773432329,
        728193750,
        92702018,
        617673175,
        550196861,
        1870163281,
        841343697,
        919803185,
        661875796,
        136635926,
        920692270,
        1023652510,
        738606198,
        651995107,
        1206494247,
        1604734497,
        488496821,
        1337944370,
        1470302473,
        30106407,
        1376725754,
        1537949700,
        163423719,
        1413214420,
        1154980312,
        956210793,
        1176948152,
        1555809389,
        318357600,
        1156675310,
        561510480,
        1971066663,
        83188346,
        879065705,
        290958575,
        544568598,
        1320203481,
        622334548,
        631989417,
        580550492,
        6169971,
        109970336,
        2123386589,
        578660700,
        238504898,
        1615404298,
        6671997,
        350592197,
        890824958,
        1469398605,
        527846071,
        518145935,
        26545625,
        877957621,
        1674076840,
        543377466,
        1013069242,
        1700556054,
        669854482,
        288666801,
        707293785,
        1049739011,
        793315912,
        1746697006,
        1049312173,
        665798727
    ];

    $mt->init(12345678);
    for ($i = 0; $i < 1024; $i++) {
        expect($mt->int31())->toEqual($expected[$i]);
    }
});

it('generates random integers within specified range', function () {
    $mt = new MersenneTwister(12345678);

    for ($i = 0; $i < 1024; $i++) {
        $min = rand(0, 1000);
        $max = rand($min, 2000);
        $randomValue = $mt->rand($min, $max);
        expect($randomValue)->toBeGreaterThanOrEqual($min)->toBeLessThanOrEqual($max);
    }
});

it('throws exception for invalid range in rand', function () {
    $mt = new MersenneTwister(12345678);
    $mt->rand(10, 5);
})->throws(\InvalidArgumentException::class, "Minimum value cannot be greater than maximum value.");

it('generates random floats within specified range', function () {
    $mt = new MersenneTwister(12345678);

    for ($i = 0; $i < 1024; $i++) {
        $min = rand(0, 1000) / 10.0;
        $max = rand($min * 10, 2000) / 10.0;
        $randomValue = $mt->randFloat($min, $max);
        expect($randomValue)->toBeGreaterThanOrEqual($min)->toBeLessThanOrEqual($max);
    }
});

it('throws exception for invalid range in randFloat', function () {
    $mt = new MersenneTwister(12345678);
    $mt->randFloat(10.5, 5.5);
})->throws(\InvalidArgumentException::class, "Minimum value cannot be greater than maximum value.");

it('returns the seed value', function () {
    $mt = new MersenneTwister(12345678);
    expect($mt->getSeed())->toBeInt()->toEqual(12345678);
});